import{e,d as l,p as a,b as d,y as o,L as t,r,o as n,c as i,i as s,j as m,t as u,w as c}from"./vendor.47dfe678.js";import{a as f}from"./index.f0cfd1f9.js";const b={name:"role",setup(){const a=e({address:"",name:"",pageIndex:1,pageSize:10});e([{id:""}]);const d=l([]),r=l(0),n=()=>{f.getRoles().then((e=>{d.value.splice(0,d.value.length),200==e.code?e.data.forEach((e=>{d.value.push(e)})):o.error(e.message)}))};n();const i=l(!1);let s=e({id:"",name:"",resource:"",describe:""});let m=l(!1);return{query:a,tableData:d,pageTotal:r,editVisible:i,addVisible:m,form:s,handleSearch:()=>{a.pageIndex=1,n()},handlePageChange:e=>{a.pageIndex=e,n()},handleDelete:(e,l)=>{t.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{f.deleteRole(l.id).then((e=>{200===e.code?(o.success("删除成功"),n()):o.error(e.message)}))})).catch((()=>{}))},handleEdit:(e,l)=>{s.id=l.id,Object.keys(s).forEach((e=>{s[e]=l[e]})),i.value=!0},saveEdit:()=>{f.updateRole(s).then((e=>{200===e.code?(i.value=!1,o.success("修改成功"),n()):o.error(e.message)}))},handleAdd:()=>{Object.keys(s).forEach((e=>{s[e]=""})),m.value=!0},addRole:()=>{f.addRole(s).then((e=>{200===e.code?(o.success("添加成功"),m.value=!1,n()):o.error(e.message)}))},handleGrant:()=>{}}},data:()=>({grantVisible:!1,hasPermission:[],data:[]}),methods:{handleGrant(e,l){this.grantVisible=!this.grantVisible},filterMethod:(e,l)=>l.spell.indexOf(e)>-1,handleChange(e,l,a){}}},h=c();a("data-v-403e636f");const p={class:"crumbs"},V=s("i",{class:"el-icon-lx-cascades"},null,-1),g=m(" 角色管理 "),_={class:"container"},w={class:"handle-box"},C=m("编辑 "),v=m("删除"),x={class:"dialog-footer"},U=m("取 消"),O=m("确 定"),k={class:"dialog-footer"},N=m("取 消"),y=m("确 定");d();const A=h(((e,l,a,d,o,t)=>{const c=r("el-breadcrumb-item"),f=r("el-breadcrumb"),b=r("el-button"),A=r("el-table-column"),M=r("el-table"),S=r("el-input"),E=r("el-form-item"),R=r("el-form"),Y=r("el-dialog"),j=r("el-transfer");return n(),i("div",null,[s("div",p,[s(f,{separator:"/"},{default:h((()=>[s(c,null,{default:h((()=>[V,g])),_:1})])),_:1})]),s("div",_,[s("div",w,[s(b,{icon:"el-icon-lx-add",onClick:d.handleAdd,circle:""},null,8,["onClick"])]),s(M,{data:d.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:h((()=>[s(A,{prop:"id",label:"ID",width:"55",align:"center"}),s(A,{prop:"name",label:"角色名"}),s(A,{label:"持有资源"},{default:h((e=>[m(u(e.row.resource),1)])),_:1}),s(A,{label:"角色描述"},{default:h((e=>[m(u(e.row.describe),1)])),_:1}),s(A,{label:"操作",align:"center"},{default:h((e=>[s(b,{disabled:"ANONYMOUS"===e.row.name||"root"===e.row.name,type:"text",icon:"el-icon-edit",onClick:l=>d.handleEdit(e.$index,e.row)},{default:h((()=>[C])),_:2},1032,["disabled","onClick"]),s(b,{disabled:"ANONYMOUS"===e.row.name||"root"===e.row.name,type:"text",icon:"el-icon-delete",class:"ANONYMOUS"===e.row.name||"root"===e.row.name?"":"red",onClick:l=>d.handleDelete(e.$index,e.row)},{default:h((()=>[v])),_:2},1032,["disabled","class","onClick"])])),_:1})])),_:1},8,["data"])]),s(Y,{title:"编辑",modelValue:d.editVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>d.editVisible=e),width:"30%"},{footer:h((()=>[s("span",x,[s(b,{onClick:l[4]||(l[4]=e=>d.editVisible=!1)},{default:h((()=>[U])),_:1}),s(b,{type:"primary",onClick:d.saveEdit},{default:h((()=>[O])),_:1},8,["onClick"])])])),default:h((()=>[s(R,{"label-width":"70px"},{default:h((()=>[s(E,{label:"角色名"},{default:h((()=>[s(S,{disabled:"ANONYMOUS"===d.form.name||"root"===d.form.name,modelValue:d.form.name,"onUpdate:modelValue":l[1]||(l[1]=e=>d.form.name=e)},null,8,["disabled","modelValue"])])),_:1}),s(E,{label:"持有资源"},{default:h((()=>[s(S,{disabled:"ANONYMOUS"===d.form.name||"root"===d.form.name,modelValue:d.form.resource,"onUpdate:modelValue":l[2]||(l[2]=e=>d.form.resource=e)},null,8,["disabled","modelValue"])])),_:1}),s(E,{label:"角色介绍"},{default:h((()=>[s(S,{disabled:"ANONYMOUS"===d.form.name||"root"===d.form.name,modelValue:d.form.describe,"onUpdate:modelValue":l[3]||(l[3]=e=>d.form.describe=e)},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),s(Y,{title:"添加角色",modelValue:d.addVisible,"onUpdate:modelValue":l[10]||(l[10]=e=>d.addVisible=e),width:"30%"},{footer:h((()=>[s("span",k,[s(b,{onClick:l[9]||(l[9]=e=>d.editVisible=!1)},{default:h((()=>[N])),_:1}),s(b,{type:"primary",onClick:d.addRole},{default:h((()=>[y])),_:1},8,["onClick"])])])),default:h((()=>[s(R,{"label-width":"70px"},{default:h((()=>[s(E,{label:"角色名"},{default:h((()=>[s(S,{modelValue:d.form.name,"onUpdate:modelValue":l[6]||(l[6]=e=>d.form.name=e)},null,8,["modelValue"])])),_:1}),s(E,{label:"资源描述"},{default:h((()=>[s(S,{modelValue:d.form.resource,"onUpdate:modelValue":l[7]||(l[7]=e=>d.form.resource=e)},null,8,["modelValue"])])),_:1}),s(E,{label:"角色描述"},{default:h((()=>[s(S,{modelValue:d.form.describe,"onUpdate:modelValue":l[8]||(l[8]=e=>d.form.describe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),s(Y,{modelValue:o.grantVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>o.grantVisible=e),width:"650px"},{default:h((()=>[s(j,{modelValue:o.hasPermission,"onUpdate:modelValue":l[11]||(l[11]=e=>o.hasPermission=e),filterable:"","filter-method":t.filterMethod,"filter-placeholder":"请输入角色名",titles:["未拥有权限","已拥有权限"],data:o.data,onChange:t.handleChange},null,8,["modelValue","filter-method","data","onChange"])])),_:1},8,["modelValue"])])}));b.render=A,b.__scopeId="data-v-403e636f";export default b;
